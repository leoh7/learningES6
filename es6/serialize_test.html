<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Serialize_Test</title>
	<script src="./jquery-3.3.1.js"></script>
	<script src="./jquery.serialize-object.min.js"></script>
	<script
			src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
			integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
			crossorigin="anonymous"></script>
	<script
		src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
		integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
		crossorigin="anonymous"></script>
	<link 
		rel="stylesheet" 
		href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" 
		integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU"
		crossorigin="anonymous">
</head>
<body>
	<div class="container" style="width: 800px;">
			<form id="tripForm" class="form" method="post">
				<div class="input-box">	
					<div class="board_part">
						<input type="hidden" name="board[]">
							<div class="form-group row">
								<input type="text" class="board_title " name="board[title]" placeholder="제목">
							</div>
							<div class="form-group row"><label for="board_content">글내용</label>
								<textarea class="board_content" name="board[content]" placeholder="내용을 입력하세요">
								</textarea>
							</div>
							<div class="form-group row"><label for="board_contact">대화링크</label>
								<input type="text" class="board_contact" name="board[contact]">
							</div>
							<div class="form-group row">
								<input type="checkbox" class="board_tag" name="board[tag][]" value="tag1">태그1
								<input type="checkbox" class="board_tag" name="board[tag][]" value="tag2">태그2
								<input type="checkbox" class="board_tag" name="board[tag][]" value="tag3">태그3
							</div>
					</div>
					<div class="trip_part">
						<input type="hidden" name="trip[]">
						<div class="form-group row">
							<label for="trip_member_count">참여인원</label>
							<input type="number" class="trip_member_count" name="trip[][member_count]" placeholder="n명">
						</div>
						<div class="form-group row">
							<input type="text" class="trip_start_date" name="trip[][start_date]" placeholder="시작일">
							~
							<input type="text" class="trip_end_date" name="trip[][end_date]" placeholder="종료일">
						</div>
							<input type="hidden" name="trip[][coord_id]">
								<input type="hidden" class="trip_place_name" name="trip[][coord_id][place_name]">
								<input type="hidden" class="trip_country_code" name="trip[][coord_id][country_code]">
								<input type="hidden" class="trip_long" name="trip[][coord_id][long]">
								<input type="hidden" class="trip_lat" name="trip[][coord_id][lat]">
							<input type="hidden" class="trip_order" name="trip[][trip_order]" value="1">
					</div>
				</div>
				<input type="submit" value="전송">
			</form>
			<button id="add_btn">추가</button>
		</div>

<!-- 다음과 같은 내용이 본문에 중복되어 들어가도 tree형태를 구성하는데 무리가 없다.
		<input type="hidden" name="trip[]" value="trip2">
			<input type="number" name="trip[][member_count]" value="member_count2">
			<input type="hidden" name="trip[][coord_id]" value="coord_id2">
				<input type="hidden" name="trip[][coord_id][place_name]" value="place_name2">
				<input type="hidden" name="trip[][coord_id][country_code]" value="country_code2">
				<input type="hidden" name="trip[][coord_id][long]" value="long2">
				<input type="hidden" name="trip[][coord_id][lat]" value="lat2">
			<input type="text" name="trip[][start_date]" value="start_date2">
			<input type="text" name="trip[][end_date]" value="end_date2">
			<input type="hidden" name="trip[][trip_order]" value="trip_order2">		 
-->



<!-- tree 형태의 node. JSON 혹은 Object화 할 수 있다. 
board[]
	board[title]
	board[content]
	board[contact]
	board[tag]
		board[tag][]
trip[]
	trip[][member_count]
	trip[][coord_id]
		trip[][coord_id][place_name]
		trip[][coord_id][country_code]
		trip[][coord_id][long]
		trip[][coord_id][lat]
	trip[][start_date]
	trip[][end_date]
	trip[][trip_order] 
-->


<!-- example 1 : 같은 name 을 갖고 있는 element들을 배열로 묶어주기
		<input name="foo[]" value="b">
			<input name="foo[][name]" value="Bname">
			<input name="foo[][address]" value="Baddress">
			<input name="foo[][tel]" value="Btel">
		<input name="foo[]" value="c">
			<input name="foo[][name]" value="Cname">
			<input name="foo[][address]" value="Caddress">
			<input name="foo[][tel]" value="Ctel"> 

	///////////////////////////////////////////////////////////////

		<input type="text" name="write[]" value="a">
		<input type="text" name="write[name][]" value="테스트1">
		<input type="text" name="write[address][]" value="주소1">
		<input type="text" name="write[address][]" value="주소2">

		<input type="text" name="write[]" value="b">
		<input type="text" name="write[name][]" value="테스트2">
		<input type="text" name="write[address][]" value="주소3">
		<input type="text" name="write[address][]" value="주소4"> 
-->


</body>
<script>
	$(function(){
		let board_data = $('form#tripForm').serializeJSON();
		let data_parse = JSON.parse(board_data);
		let trip_cnt = data_parse.trip.length;
		
		// trip 추가
		$('#add_btn').on('click', function(){
			trip_cnt ++;
//			var append = '';
//			append +=	'<div class="trip_chips">';
//			append +=	'	<input type="hidden" name="trip[]">';
//			append +=	'	<div class="form-group row">';
//			append +=	'		<label for="trip_member_count">참여인원</label>';
//			append +=	'		<input type="number" class="trip_member_count" name="trip[][member_count]" placeholder="n명">';
//			append +=	'	</div>';
//			append +=	'	<div class="form-group row">';
//			append +=	'		<input type="text" class="trip_start_date" name="trip[][start_date]" placeholder="시작일">';
//			append +=	'		~';
//			append +=	'		<input type="text" class="trip_end_date" name="trip[][end_date]" placeholder="종료일">';
//			append +=	'	</div>';
//			append +=	'		<input type="hidden" name="trip[][coord_id]">';
//			append +=	'			<input type="hidden" class="trip_place_name" name="trip[][coord_id][place_name]">';
//			append +=	'			<input type="hidden" class="trip_country_code" name="trip[][coord_id][country_code]">';
//			append +=	'			<input type="hidden" class="trip_long" name="trip[][coord_id][long]">';
//			append +=	'			<input type="hidden" class="trip_lat" name="trip[][coord_id][lat]">';
//			append +=	'		<input type="hidden" class="trip_order" name="trip[][trip_order]" value="'+trip_cnt+'">';
//			append +=	'</div>';
			$('.trip_chips')
				.eq($(this).length - 1)
				.clone()
				.appendTo('.trip_part');
//			$('.trip_part').append(append);
		});
		// trip 삭제
		
		// trip_order 변경

		// 데이터 submit 
		$('form#tripForm').on('submit', function(){
			event.preventDefault();		// 폼 처리를 완전히 jQuery 안에서 한다면, 페이지 다시 불러오기 방지
			board_data = $(this).serializeJSON();
			console.log(board_data);
		});

	});
</script>
</html>



<!-- 
{
	"foo":[
		{
			"name":"Aname",
			"address":"Aaddress",
			"tel":"Atel"
		},
		{
			"name":"Bname",
			"address":"Baddress",
			"tel":"Btel"
		},
		{
			"name":"Cname",
			"address":"Caddress",
			"tel":"Ctel"
		}
	]
}
{
	"board":{
		"title":"title",
		"content":"content",
		"contact":"contact",
		"tag":["tag1","tag2","tag3"]
	},
	"trip":[{
		"member_count":"member_count",
		"coord_id":{
			"place_name":"place_name",
			"country_code":"country_code",
			"long":"long",
			"lat":"lat"
		},
		"start_date":"start_date",
		"end_date":"end_date",
		"trip_order":"trip_order"
	}]
} -->

